<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{common/layouts/de_layout}">
<head>
<title>팩토리(PackTory) - 전자결재</title>
<!-- 부트스트랩 icons 가져오기 -->
<th:block layout:fragment="headContents">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</th:block>
<!-- CSS -->
<th:block layout:fragment="css">
	<!-- dataTables 가져오기 -->
	<link href="/css/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">
	<link href="/css/datatables/datatables.min.css" rel="stylesheet">
	<link href="/css/datepicker/daterangepicker.css" rel="stylesheet">
	<!-- 폰트어썸 가져오기 -->
	<link href="/css/fontawesome/all.min.css" rel="stylesheet">
	<script src="/css/fontawesome/all.min.js"></script>
	<!-- CSS for Page -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Nunito:wght@200..1000&display=swap" rel="stylesheet">
	<link href="/css/sb-admin-2.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">
	<!-- 개별 CSS-->
	<link href="/css/common.css" rel="stylesheet">
</th:block>
</head>

<body id="page-top">
	<!-- 기안서 작성 버튼 킵 -->

	<div layout:fragment="contents">
		<div class="container-fluid">
			<!-- Page Heading -->
			<div class="d-sm-flex align-items-center justify-content-between mb-4">
				<h1 class="h3 mb-2 text-gray-800">전자결재</h1>
			</div>
			<div class="regist-wrap">
				<input type="hidden" id="memberId" th:value="${memberId}">
				<button class="btn btn-success ml-2" id="registerBtn" type="button">기안서 작성</button>
			</div>
			<!-- ---------- 검색바 컨테이너 ---------- -->
			<div class="card shadow mb-4">
				<div class="card-body">
					<!-- ---------- 검색바 ---------- -->
					<div class="search-wrap border">
						<section class="d-flex search-inner">
						
							<div class="col pl-4 search-box">
<!-- 								<form th:action="@{/approval/search}" method="get" th:object="${orderSearchDTO}"> -->
									
<!-- 								</form> -->
							</div>
						</section>
					</div>
				</div>
			</div>
			
			<!-- 본문 컨테이너 -->
			<div class="card shadow mb-4">
				<div class="card-body">
					<!-- 그리드(테이블) -->
					<div class="table-responsive">
						<table class="table table-bordered table-hover text-center" id="approvalList" width="100%" cellspacing="0">
							<thead>
								<tr>
									<th>문서번호</th>
									<th>제목</th>
									<th>진행상태</th>
									<th>기안자</th>
									<th>기안일자</th>
									<th>마감일자</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="item, status : ${approvalDTOList}" th:data-id="${item.approvalNo}">
									<td th:text="${item.approvalNo != null ? item.approvalNo : '-'}"></td>
									<td th:text="${item.title != '' ? item.title : '-'}"></td>
									<td th:text="${item.progressName != null ? item.progressName : '-'}"></td>
									<td th:text="${item.name != null ? item.name : '-'}"></td>
									<td th:text="${item.draftDate != null ? item.draftDate : '-'}"></td>
									<td th:text="${item.dueDate != null ? item.dueDate : '-'}"></td>
								</tr>
							</tbody>
						</table>
					</div>
				 </div>
			</div>
			<!-- 본문 컨테이너 끝 -->
			
			<!-- Scroll to Top Button-->
		    <a class="scroll-to-top rounded" href="#page-top">
		    	<i class="fas fa-angle-up"></i>
		    </a>
		</div>
		
		<script type="text/javascript">
			$(document).ready(function() {
				console.log("document ready!");
				// init DataTable
				$('#approvalList').DataTable({
					lengthChange: false,
					searching: false,
					paging: false,
					info: false
				}); // end of $('#dataTables').DataTable({
				
				// 기안서 작성 버튼 클릭 이벤트(새창 열기)
				$("#registerBtn").on('click', function() {
					//로그인한 사용자 id 가져오기
// 					let userId = $("#userId").val();
					let userId = "100004"; //일단 하드코딩
					
// 					let url = `/approval/register?userId=` + userId;
//					let url = `/approval/register?userId=` + encodeURIComponent(userId); //userId보안설정
					
// 					window.open(url, '_blank', 'width=800,height=1200,scrollbars=yes,resizable=yes');
					location.href = `/groupware/approval/regist/${userId}`;
				});
				
				$("#approvalList tbody").on("click", 'tr', function() {
					console.log("dataTables tbody click!!");
					let documentNumber = $(this).data("id");
					
					if(!documentNumber) {
						return;
					}
					
					location.href="/groupware/approval/" + documentNumber;
				});
				
				
				
			}); // document.ready 끝
		</script>
	</div>
	<!-- /.container-fluid -->

<!-- JS -->
<th:block layout:fragment="script">
	<!-- Bootstrap core JavaScript-->
	<script src="/js/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="/js/jquery-3.7.1.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="/js/jquery-easing/jquery.easing.min.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="/js/sb-admin-2.min.js"></script>
   	<!-- Page level plugins -->
	<script src="/js/datatables/jquery.dataTables.min.js"></script>
	<script src="/js/datatables/dataTables.bootstrap4.min.js"></script>
	<script src="/js/demo/datatables-demo.js"></script>
<!-- 	<script src="/js/datatables/datatables.min.js"></script> --> <!-- 반응형 -->
   	<script src="/js/datepicker/moment.min.js"></script>
   	<script src="/js/datepicker/daterangepicker.js"></script>
   	<script src="/js/datatables/dataTables.buttons.min.js"></script>
	<script src="/js/datatables/buttons.html5.min.js"></script>
	<script src="/js/datatables/jszip.min.js"></script>
	<script src="/js/datatables/buttons.print.min.js"></script>
	<!-- 개별 js -->
<!--     <script src="/js/approval/approval.js"></script> -->
</th:block>
</body>
</html>


	
    
